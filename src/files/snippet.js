
require("isomorphic-fetch");
const { Client } = require("@microsoft/microsoft-graph-client");

class AuthProvider {
	getAccessToken() {
    return Promise.resolve("eyJ0eXAiOiJKV1QiLCJub25jZSI6ImRheGJfVXhnampPTy04Y3VrdEdYMmE3T2I2Q2o0RGJ2d0xjNnBwYjlzUk0iLCJhbGciOiJSUzI1NiIsIng1dCI6ImFQY3R3X29kdlJPb0VOZzNWb09sSWgydGlFcyIsImtpZCI6ImFQY3R3X29kdlJPb0VOZzNWb09sSWgydGlFcyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9mMWEwMzFhYS0wN2M0LTRmY2YtYjA3NS02YmQ4ZDA3ODExYWEvIiwiaWF0IjoxNTcyMzY2ODIxLCJuYmYiOjE1NzIzNjY4MjEsImV4cCI6MTU3MjM3MDcyMSwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IjQyVmdZTGovcVVKUVREajNIeGZMNUVYcEx3OW9XZDNPYkdsM2E5Rk1Xc3BmTVY5alR5SUEiLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6IkdyYXBoIGV4cGxvcmVyIiwiYXBwaWQiOiJkZThiYzhiNS1kOWY5LTQ4YjEtYThhZC1iNzQ4ZGE3MjUwNjQiLCJhcHBpZGFjciI6IjAiLCJmYW1pbHlfbmFtZSI6IkFkbWluaXN0cmF0b3IiLCJnaXZlbl9uYW1lIjoiTU9EIiwiaXBhZGRyIjoiMTAyLjE2Ni4xMTAuMTE0IiwibmFtZSI6Ik1PRCBBZG1pbmlzdHJhdG9yIiwib2lkIjoiZDliYjU3NjYtODc4Ni00OTRkLTkxNTUtOGZkNDM2Y2U2ODU1IiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMwMDAwQUU1MEFBREQiLCJwd2RfZXhwIjoiMzY0MjY0IiwicHdkX3VybCI6Imh0dHBzOi8vcG9ydGFsLm1pY3Jvc29mdG9ubGluZS5jb20vQ2hhbmdlUGFzc3dvcmQuYXNweCIsInNjcCI6Ikdyb3VwLlJlYWRXcml0ZS5BbGwgTm90ZXMuQ3JlYXRlIE5vdGlmaWNhdGlvbnMuUmVhZFdyaXRlLkNyZWF0ZWRCeUFwcCBvcGVuaWQgcHJvZmlsZSBTZWN1cml0eUV2ZW50cy5SZWFkLkFsbCBVc2VyLlJlYWQgZW1haWwgVXNlci5SZWFkV3JpdGUgVXNlci5SZWFkQmFzaWMuQWxsIFNpdGVzLlJlYWRXcml0ZS5BbGwgQ29udGFjdHMuUmVhZFdyaXRlIFBlb3BsZS5SZWFkIE5vdGVzLlJlYWRXcml0ZS5BbGwgVGFza3MuUmVhZFdyaXRlIE1haWwuUmVhZFdyaXRlIEZpbGVzLlJlYWRXcml0ZS5BbGwgQ2FsZW5kYXJzLlJlYWRXcml0ZSIsInNpZ25pbl9zdGF0ZSI6WyJrbXNpIl0sInN1YiI6InlsalNTcUxBd25fYmFBbkwtZVBrQ1gzdVp5WmV0bFJ2ckxCNlJjLVEydFUiLCJ0aWQiOiJmMWEwMzFhYS0wN2M0LTRmY2YtYjA3NS02YmQ4ZDA3ODExYWEiLCJ1bmlxdWVfbmFtZSI6ImFkbWluQE0zNjV4OTM1Mjc2Lm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6ImFkbWluQE0zNjV4OTM1Mjc2Lm9ubWljcm9zb2Z0LmNvbSIsInV0aSI6IkRpYkFUVkx6WlUtNUQ3d3JLalJjQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjYyZTkwMzk0LTY5ZjUtNDIzNy05MTkwLTAxMjE3NzE0NWUxMCJdLCJ4bXNfc3QiOnsic3ViIjoiQmJMUldhSHFxdmdxQmptT3Y2NUJFbkYzaTBwTnNwZ0steWY0d0JCdkx0OCJ9LCJ4bXNfdGNkdCI6MTUzODQ4NTkwOH0.BcJmunnxAGWi6hN5wK-1tqkVaOlFqL-CFIo7tlHiiG_fkepYr4llzGInTJj68Jj0glWFkBAFBv2t_encH6iG-Azexx99M6d9s0Rtfc9h70BVHfNN-Q9mXRYELIIigUsGnHMjwavQ43HLeCbq1cumovJpkeS5uiaun6_6lThDp7Wls1HApGwu6N01vkYuYm8vPGaVF-6q2j4ht5QVWn271oe_3RFVN3jYi6xI1hPSeUjdWnYXyoUS-oA1m_bQ0-VjlcTt5fl92lM2CDbP8AcueVN1p1M5IBwp88DRdaTmHSjgkO-aMwmGPb7DcXuIfBz4uxJOj96dsYU2Ch_dbrvwDg");
	}
}

const authProvider = new AuthProvider();
Client.init = Client.initWithMiddleware;

async function runSnippet() {
  const options = {
	authProvider,
};

const client = Client.init(options);

let res = await client.api('/me/')
  .get();

console.log(res);
}

runSnippet();

module.exports = { runSnippet }
